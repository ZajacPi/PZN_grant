#include<mpu6050.h>

extern I2C_HandleTypeDef hi2c1;

void mpu6050_init(){
	printf("Checking connection...\n");
	  HAL_StatusTypeDef ret = HAL_I2C_IsDeviceReady(&hi2c1, MPU6050_ADDR, 1, 100);
	  if (ret == HAL_OK){
		  printf(".................................................\n");
		  printf("Device ready!\n");
	  }
	  else{
		  printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
		  printf("Device not detected. Check connection.\n");
		  printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
	  }
	  uint8_t temp_data = 0b00001000;
	  ret = HAL_I2C_Mem_Write(&hi2c1, MPU6050_ADDR, CONFIG_GYRO, 1, &temp_data, 1, 100);
	  if (ret == HAL_OK){
		  printf("Gyroscope configured!\n");
		  printf(".................................................\n");
	  }
	  else{
		  printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
		  printf("Cannot configure gyroscope.\n");
		  printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");

	  }
}
